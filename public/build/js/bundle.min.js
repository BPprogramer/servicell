!function(){if(document.querySelector("#navReparacionCliente")){const e=document.querySelector("#btnEstadoReparacion"),t=document.querySelector("#btnTotalReparacion"),n=document.querySelector("#btnImprimirReparacion");!async function(){const a=document.querySelector("#idReparacion").dataset.reparacionId,o=`${location.origin}/api/reparacion/estado-actual?id=${a}`;try{const a=await fetch(o),c=await a.json();!function(t){0==t.estado&&(e.classList.add("bg-secondary"),e.textContent="Pendiente");1==t.estado&&(e.classList.remove("bg-secondary"),e.classList.add("bg-success"),e.textContent="Reparado");2==t.estado&&(e.classList.remove("bg-success"),e.classList.add("bg-danger"),e.textContent="Cerrado");e.dataset.estado=t.estado,2!=t.estado&&e.addEventListener("click",(function(){alertaCambiarEstado(t)}))}(c),function(e){if(0==e.estado)t.innerHTML="Total: <strong></strong>";else{const n=parseFloat(e.valor_final)-parseFloat(e.abono)+parseFloat(e.costo_final);t.innerHTML=`Total: <strong>$${parseFloat(n).toLocaleString("en")}</strong>`}}(c),function(e){0!=e.estado&&n.addEventListener("click",(function(e){console.log("imprimiendo")}))}(c)}catch(e){}}()}}(),function(){if(document.querySelector("#tabla-costos-cliente")){const e=document.querySelector("#totalIngresos");!async function(){const t=document.querySelector("#idReparacion").dataset.reparacionId,n=`${location.origin}/api/reparacion/ingresos?id=${t}`;try{const t=await fetch(n);!function(t){console.log(t);const n=document.querySelector("#tabla-costos-cliente"),a=document.createElement("tbody"),o=t.reduce((function(e,t){return e+parseFloat(t.ingreso)}),0);e.textContent=o.toLocaleString("en"),t.forEach(e=>{const{id:t,ingreso:n,descripcion:o,reparacion_id:c}=e,r=document.createElement("tr"),s=document.createElement("td");s.classList.add("py-2"),s.style.minWidth="130px",s.innerHTML=`Valor: $<strong>${parseFloat(n).toLocaleString("en")}</strong>`;const i=document.createElement("td");i.classList.add("py-2"),i.innerHTML=`Descripcion: <strong style="max-width:30px !important">${o}</strong>`,r.appendChild(s),r.appendChild(i),a.appendChild(r)}),n.appendChild(a)}(await t.json())}catch(e){}}()}}(),function(){if(document.querySelector("#navReparacionCliente")){const e=document.querySelector("#general"),t=document.querySelector("#notificaciones"),n=document.querySelector("#avanzado"),a=document.querySelector("#info_general"),o=document.querySelector("#info_notificaciones"),c=document.querySelector("#info_avanzado");e.addEventListener("click",()=>{document.querySelector(".active-nav").classList.remove("active-nav"),e.classList.add("active-nav");document.querySelectorAll(".d-none").forEach(e=>{e.classList.remove("d-none")}),o.classList.add("d-none"),c.classList.add("d-none")}),t.addEventListener("click",()=>{document.querySelector(".active-nav").classList.remove("active-nav"),t.classList.add("active-nav");document.querySelectorAll(".d-none").forEach(e=>{e.classList.remove("d-none")}),a.classList.add("d-none"),c.classList.add("d-none")}),n.addEventListener("click",()=>{document.querySelector(".active-nav").classList.remove("active-nav"),n.classList.add("active-nav");document.querySelectorAll(".d-none").forEach(e=>{e.classList.remove("d-none")}),o.classList.add("d-none"),a.classList.add("d-none")})}}(),function(){if(document.querySelector("#tabla-notificaciones-cliente")){document.querySelector("#contenedorImganes");function e(e){for(;e.firstChild;)e.removeChild(e.firstChild)}!async function(){const t=document.querySelector("#idReparacion").dataset.reparacionId,n=`${location.origin}/api/reparacion/notificaciones?id=${t}`;try{const t=await fetch(n);!function(t){const n=document.querySelector("#tabla-notificaciones-cliente");e(n);const a=document.createElement("tbody");let o=0;t.forEach(t=>{o++;const{id:n,mensaje:c,imagenes:r}=t,s=document.createElement("tr"),i=document.createElement("TD"),l=document.createElement("DIV");l.classList.add("row","d-flex","justify-content-between");const d=document.createElement("P");d.classList.add("col-md-7"),d.innerHTML="<strong>Mensaje:</strong><br>"+c;const u=document.createElement("DIV");u.id="carousel_"+o,u.classList.add("carousel","slide","float-right","col-md-4"),u.dataset.ride="carousel",u.style.maxWidth="40rem",u.style.maxHeight="40rem",u.style.padding="10px";const m=document.createElement("OL");m.classList.add("carousel-indicators");const p=document.createElement("DIV");p.classList.add("carousel-inner");let g=1;r.forEach(e=>{if(""!=e){const t=document.createElement("LI");t.dataset.target="#carousel_"+o,t.dataset.slideTo=""+g;const n=document.createElement("DIV");n.classList.add("carousel-item");const a=document.createElement("IMG");a.classList.add("d-block","w-100"),a.src=`/img/notificaciones/${e}.png`,1==g&&(t.classList.add("active"),n.classList.add("active")),m.appendChild(t),n.appendChild(a),p.appendChild(n),g++}});const h=document.createElement("A");h.classList.add("carousel-control-prev"),h.href="#carousel_"+o,h.setAttribute("role","button"),h.dataset.slide="prev",h.innerHTML='\n                          <span class="carousel-control-prev-icon" aria-hidden="true"></span>\n                          <span class="sr-only">Previous</span>\n              ';const f=document.createElement("A");f.classList.add("carousel-control-next"),f.href="#carousel_"+o,f.setAttribute("role","button"),f.dataset.slide="next",f.innerHTML=' \n                          <span class="carousel-control-next-icon" aria-hidden="true"></span>\n                          <span class="sr-only">Next</span>\n              ',u.appendChild(m),u.appendChild(p),u.appendChild(h),u.appendChild(f),u.ondblclick=()=>{!function(t){const n=document.querySelector("#contenedor_carrousel_grande");e(n);const a=document.createElement("DIV");a.id="carousel_grande",a.classList.add("carousel","slide","float-right","col-md-3"),a.dataset.ride="carousel",a.style.maxWidth="40rem",a.style.maxHeight="40rem",a.style.padding="0px";const o=document.createElement("OL");o.classList.add("carousel-indicators");const c=document.createElement("DIV");c.classList.add("carousel-inner");let r=1;t.forEach(e=>{if(""!=e){const t=document.createElement("LI");t.dataset.target="#carousel_grande",t.dataset.slideTo=""+r;const n=document.createElement("DIV");n.classList.add("carousel-item");const a=document.createElement("IMG");a.classList.add("d-block","w-100"),a.src=`/img/notificaciones/${e}.png`,1==r&&(t.classList.add("active"),n.classList.add("active")),o.appendChild(t),n.appendChild(a),c.appendChild(n),r++}});const s=document.createElement("A");s.classList.add("carousel-control-prev"),s.href="#carousel_grande",s.setAttribute("role","button"),s.dataset.slide="prev",s.innerHTML='\n                      <span class="carousel-control-prev-icon" aria-hidden="true"></span>\n                      <span class="sr-only">Previous</span>\n          ';const i=document.createElement("A");i.classList.add("carousel-control-next"),i.href="#carousel_grande",i.setAttribute("role","button"),i.dataset.slide="next",i.innerHTML=' \n                      <span class="carousel-control-next-icon" aria-hidden="true"></span>\n                      <span class="sr-only">Next</span>\n          ',a.appendChild(o),a.appendChild(c),a.appendChild(s),a.appendChild(i),$("#modal-carrousel-imagenes").modal("show"),n.appendChild(a)}(r)},l.appendChild(u),l.appendChild(d),i.appendChild(l),s.appendChild(i),a.appendChild(s)}),n.appendChild(a)}(await t.json())}catch(e){}}()}}(),function(){if(document.querySelector("#informacionCompleta")){const e=document.querySelector("#ingresos"),t=document.querySelector("#gastos"),n=document.querySelector("#ganancias"),a=document.querySelector("#ganancias_mes_actual"),o=document.querySelector("#ganancias_3_meses"),c=document.querySelector("#pendientes"),r=document.querySelector("#reparados"),s=document.querySelector("#cerrados");!async function(){const i=location.origin+"/api/dashboard";try{const l=await fetch(i),d=await l.json();console.log(d),function(i){e.textContent="$"+(parseFloat(i.ingresos_totales)+parseFloat(i.gastos_totales)).toLocaleString("en"),t.textContent="$"+parseFloat(i.gastos_totales).toLocaleString("en"),n.textContent="$"+parseFloat(i.ingresos_totales).toLocaleString("en"),a.textContent="$"+parseFloat(i.ganancias_mes_actual).toLocaleString("en"),o.textContent="$"+parseFloat(i.ganancias_3_meses).toLocaleString("en"),c.textContent=i.pendientes,r.textContent=i.reparados,s.textContent=i.cerrados}(d)}catch(e){console.log(e)}}()}}(),function(){if(document.querySelector("#loginForm")){const n=document.querySelector("#email"),a=document.querySelector("#password"),o=document.querySelector("#btnSubmit");async function e(){o.disabled=!0;const e=new FormData;e.append("email",n.value.trim()),e.append("password",a.value);try{const t="/usuario/login",n=await fetch(t,{body:e,method:"POST"}),a=await n.json();document.querySelector("#toastsContainerTopRight")&&document.querySelector("#toastsContainerTopRight").remove(),"error"==a.type?(o.disabled=!1,$(document).Toasts("create",{class:"bg-danger",title:"Error",body:a.msg})):(1==a.roll&&(window.location.href="/inicio"),2==a.roll&&(window.location.href="/clientes"))}catch(e){}}function t(){console.log("asdf"),$.validator.setDefaults({submitHandler:function(){e()}}),$("#loginForm").validate({rules:{email:{required:!0},password:{required:!0}},messages:{email:{required:"El usuario es obligatorio"},password:{required:"El password es obligatorio"}},errorElement:"span",errorPlacement:function(e,t){e.addClass("invalid-feedback"),t.closest(".form-group").append(e)},highlight:function(e,t,n){$(e).addClass("is-invalid")},unhighlight:function(e,t,n){$(e).removeClass("is-invalid")}})}t(),$("#loginForm").on("valid",(function(e){t()}))}}(),function(){if(document.querySelector("#usuarios")){let c,r=null;const s=document.querySelector("#registrar"),i=document.querySelector("#usuarioForm"),l=document.querySelector("#btnSubmit"),d=document.querySelector("#nombre"),u=document.querySelector("#email"),m=document.querySelector("#estado"),p=document.querySelector("#roll"),g=document.querySelector("#password");function e(){document.querySelectorAll("#editar").forEach(e=>{e.addEventListener("click",(function(e){r=e.currentTarget.dataset.usuarioId,t()}))});document.querySelectorAll("#eliminar").forEach(e=>{e.addEventListener("click",(function(e){!function(e,t){const a=t.currentTarget.parentElement.parentElement.parentElement.childNodes[1].textContent;Swal.fire({icon:"warning",html:`<h2 class="">esta seguro de eliminar al usuario <span class="font-weight-bold"> ${a} </span>?</h2><br><p>Esta acción no se puede deshacer</p>`,showCancelButton:!0,confirmButtonText:"Eliminar",cancelButtonText:"Cancelar"}).then(t=>{t.isConfirmed&&async function(e){const t=new FormData;t.append("id",e),url=location.origin+"/usuario/eliminar";try{const e=await fetch(url,{body:t,method:"POST"}),a=await e.json();n(),"error"==a.type?$(document).Toasts("create",{class:"bg-danger",title:"Error",body:a.msg}):($(document).Toasts("create",{class:"bg-azul text-blanco",title:"Completado",body:a.msg}),setTimeout(()=>{n()},8e3),c.ajax.reload())}catch(e){console.log(e)}}(e)})}(e.currentTarget.dataset.usuarioId,e)}))})}function t(){$("#usuarioForm").validate().destroy(),i.reset(),l.disabled=!1,a(m),a(p);const e=document.createElement("OPTION");e.setAttribute("disabled","disabled"),e.setAttribute("selected","selected"),e.textContent="--Seleccione--";const t=document.createElement("OPTION");t.value=0,t.textContent="Inactivo";const n=document.createElement("OPTION");n.value=1,n.textContent="Activo";const c=document.createElement("OPTION");c.setAttribute("disabled","disabled"),c.setAttribute("selected","selected"),c.textContent="--Seleccione--";const s=document.createElement("OPTION");s.value=0,s.textContent="Vendedor";const g=document.createElement("OPTION");g.value=1,g.textContent="Administrador";const h=document.createElement("OPTION");h.value=2,h.textContent="Cliente",m.appendChild(e),m.appendChild(t),m.appendChild(n),p.appendChild(c),p.appendChild(s),p.appendChild(g),p.appendChild(h),$("#modal-usuario").modal("show"),o(),r&&async function(){try{const e=await fetch("/api/usuario?id="+r);!function(e){d.value=e.nombre,u.value=e.email;m.querySelector('option[value="'+e.estado+'"]').setAttribute("selected","selected");p.querySelector('option[value="'+e.roll+'"]').setAttribute("selected","selected")}(await e.json())}catch(e){console.log(e)}}()}function n(){document.querySelector("#toastsContainerTopRight")&&document.querySelector("#toastsContainerTopRight").remove()}function a(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function o(){$.validator.setDefaults({submitHandler:function(){!async function(){const e=new FormData;r&&e.append("id",r),e.append("nombre",d.value.trim()),e.append("email",u.value),e.append("estado",m.value),e.append("roll",p.value),e.append("password",g.value),l.disabled=!0;let t="";t=r?location.origin+"/usuario/editar":location.origin+"/usuario/crear";try{const a=await fetch(t,{body:e,method:"POST"}),o=await a.json();console.log(o),l.disabled=!1,n(),l.disabled=!1,"error"==o.type?$(document).Toasts("create",{class:"bg-danger",title:"Error",body:o.msg}):($(document).Toasts("create",{class:"bg-primary",title:"Completado",body:o.msg}),setTimeout(()=>{n()},4e3),i.reset(),$("#modal-usuario").modal("hide"),c.ajax.reload())}catch(e){}}()}});let e={},t={};r||(e={required:!0,minlength:6},t={required:"El password es obligatorio",minlength:"El Password debe tener al menos 6 caracteres"}),$("#usuarioForm").validate({rules:{nombre:{required:!0},email:{required:!0},estado:{required:!0},roll:{required:!0},password:e,terms:{required:!0}},messages:{nombre:{required:"El nombre es obligatorio"},email:{required:"El email es obligatorio"},estado:{required:"el estado es obligatorio"},roll:{required:"el Roll es obligatorio"},password:t},errorElement:"span",errorPlacement:function(e,t){e.addClass("invalid-feedback"),t.closest(".form-group").append(e)},highlight:function(e,t,n){$(e).addClass("is-invalid")},unhighlight:function(e,t,n){$(e).removeClass("is-invalid")}})}s.addEventListener("click",(function(){r=null,t()})),$("#tabla").dataTable().fnDestroy(),c=$("#tabla").DataTable({ajax:"/api/usuarios",deferRender:!0,retrieve:!0,proccesing:!0,responsive:!0,initComplete:function(){new $.fn.dataTable.Buttons(c,{buttons:["copy","csv","excel","pdf","print","colvis"]}).container().appendTo("#tabla_wrapper .col-md-6:eq(0)")}}),c.on("draw",e),$("#usuarioForm").on("valid",(function(e){o()}))}}(),function(){const e=document.querySelector("#btnEstadoReparacion");if(e){const o=document.querySelector("#btnTotalReparacion"),c=document.querySelector("#btnImprimirReparacion");async function t(){const r=n(),s=`${location.origin}/api/reparacion/estado-actual?id=${r}`;try{const n=await fetch(s),r=await n.json();!function(n){0==n.estado&&(e.classList.add("bg-secondary"),e.textContent="Pendiente");1==n.estado&&(e.classList.remove("bg-secondary"),e.classList.add("bg-success"),e.textContent="Reparado");2==n.estado&&(e.classList.remove("bg-success"),e.classList.add("bg-danger"),e.textContent="Cerrado");e.dataset.estado=n.estado,2!=n.estado&&e.addEventListener("click",(function(){!function(e){let n="";0==e.estado&&(n='<h2 class="">Acepta estar seguro de dar por  <span class="font-weight-bold"> REPARADO </span> el dispositvo?</h2><br><p>Esta acción no se puede deshacer</p> ');1==e.estado&&(n='<h2 class="">Acepta estar seguro de dar por  <span class="font-weight-bold"> FINALIZADA </span> esta reparación?</h2><br><p>Esta acción no se puede deshacer</p>');Swal.fire({icon:"warning",html:n,showCancelButton:!0,confirmButtonText:"Seguro",cancelButtonText:"Cancelar"}).then(n=>{n.isConfirmed&&async function(e){const n=parseInt(e.estado)+1,o=new FormData;o.append("estado",n),o.append("reparacion_id",e.id),o.append("cliente_id",e.cliente_id);try{const e=await fetch("/api/reparacion/cambiar-estado",{body:o,method:"POST"}),n=await e.json();a(),"error"==n.type?$(document).Toasts("create",{class:"bg-danger",title:"Error",body:n.msg}):($(document).Toasts("create",{class:"bg-azul text-blanco",title:"Completado",body:n.msg}),setTimeout(()=>{a()},8e3),t())}catch(e){}}(e)})}(n)}))}(r),function(e){if(0==e.estado)o.innerHTML="Total: <strong></strong>";else{const t=parseFloat(e.valor_final)-parseFloat(e.abono)+parseFloat(e.costo_final);o.innerHTML=`Total: <strong>$${parseFloat(t).toLocaleString("en")}</strong>`}}(r),function(e){0!=e.estado&&c.addEventListener("click",(function(){!async function(e){const t="/api/factura-finalizada?key="+btoa(e);try{await fetch(t);window.open(t,"_blank")}catch(e){}}(e.id)}))}(r)}catch(e){}}function n(){const e=window.location.href,t=new URL(e);return id=t.searchParams.get("id")}function a(){document.querySelector("#toastsContainerTopRight")&&document.querySelector("#toastsContainerTopRight").remove()}t()}}(),function(){if(document.querySelector("#navReparacion")){const e=document.querySelector("#general"),t=document.querySelector("#notificaciones"),n=document.querySelector("#avanzado"),a=document.querySelector("#info_general"),o=document.querySelector("#info_notificaciones"),c=document.querySelector("#info_avanzado");e.addEventListener("click",()=>{document.querySelector(".active-nav").classList.remove("active-nav"),e.classList.add("active-nav");document.querySelectorAll(".d-none").forEach(e=>{e.classList.remove("d-none")}),o.classList.add("d-none"),c.classList.add("d-none")}),t.addEventListener("click",()=>{document.querySelector(".active-nav").classList.remove("active-nav"),t.classList.add("active-nav");document.querySelectorAll(".d-none").forEach(e=>{e.classList.remove("d-none")}),a.classList.add("d-none"),c.classList.add("d-none")}),n.addEventListener("click",()=>{document.querySelector(".active-nav").classList.remove("active-nav"),n.classList.add("active-nav");document.querySelectorAll(".d-none").forEach(e=>{e.classList.remove("d-none")}),o.classList.add("d-none"),a.classList.add("d-none")})}}(),function(){if(document.querySelector("#tabla-notificaciones")){const r=document.querySelector("#btnSubmitNotificacion"),s=document.querySelector("#agregar-notificacion"),i=document.querySelector("#notificacionForm"),l=document.querySelector("#mensaje"),d=document.querySelector("#imagenes"),u=document.querySelector("#contenedorImganes");let m;async function e(){const c=a(),r=`${location.origin}/api/reparacion/notificaciones?id=${c}`;try{const a=await fetch(r);!function(a){const c=document.querySelector("#tabla-notificaciones");n(c);const r=document.createElement("tbody");let s=0;a.forEach(a=>{s++;const{id:c,mensaje:i,imagenes:l}=a,d=document.createElement("tr"),u=document.createElement("TD"),m=document.createElement("DIV");m.classList.add("row","d-flex","justify-content-between");const p=document.createElement("P");p.classList.add("col-md-6"),p.innerHTML="<strong>Mensaje:</strong><br>"+i;const g=document.createElement("DIV");g.classList.add("col-md2");const h=document.createElement("BUTTON");h.type="button",h.classList.add("btn","btn-sm","bg-hover-azul","mx-2","text-white","toolMio"),h.innerHTML="<span class='toolMio-text'>Editar</span><i class='fas fa-pen'></i>",h.style.maxHeight="40px",h.style.maxWidth="40px",h.onclick=function(){t(a)};const f=document.createElement("BUTTON");f.type="button",f.classList.add("btn","btn-sm","bg-hover-azul","mx-2","text-white","toolMio"),f.innerHTML="<span class='toolMio-text'>Eliminar</span><i class='fas fa-trash'></i>",f.type="button",f.style.maxHeight="40px",f.style.maxWidth="40px",f.onclick=function(){!function(t){Swal.fire({icon:"warning",title:"Esta seguro de eliminar esta Notificación?",text:"Esta acción no se puede deshacer",showCancelButton:!0,confirmButtonText:"Eliminar",cancelButtonText:"Cancelar"}).then(n=>{n.isConfirmed&&async function(t){const n=new FormData;n.append("id",t);try{const t=await fetch("/api/reparacion/eliminar-notificacion",{body:n,method:"POST"}),a=await t.json();"error"==a.type?$(document).Toasts("create",{class:"bg-danger",title:"Error",body:a.msg}):($(document).Toasts("create",{class:"bg-azul text-blanco",title:"Completado",body:a.msg}),setTimeout(()=>{o()},8e3),e())}catch(e){}}(t.id)})}(a)};const y=document.createElement("DIV");y.id="carousel_"+s,y.classList.add("carousel","slide","float-right","col-md-3"),y.dataset.ride="carousel",y.style.maxWidth="40rem",y.style.maxHeight="40rem",y.style.padding="10px";const b=document.createElement("OL");b.classList.add("carousel-indicators");const v=document.createElement("DIV");v.classList.add("carousel-inner");let C=1;l.forEach(e=>{if(""!=e){const t=document.createElement("LI");t.dataset.target="#carousel_"+s,t.dataset.slideTo=""+C;const n=document.createElement("DIV");n.classList.add("carousel-item");const a=document.createElement("IMG");a.classList.add("d-block","w-100"),a.src=`/img/notificaciones/${e}.png`,1==C&&(t.classList.add("active"),n.classList.add("active")),b.appendChild(t),n.appendChild(a),v.appendChild(n),C++}});const S=document.createElement("A");S.classList.add("carousel-control-prev"),S.href="#carousel_"+s,S.setAttribute("role","button"),S.dataset.slide="prev",S.innerHTML='\n                          <span class="carousel-control-prev-icon" aria-hidden="true"></span>\n                          <span class="sr-only">Previous</span>\n              ';const L=document.createElement("A");L.classList.add("carousel-control-next"),L.href="#carousel_"+s,L.setAttribute("role","button"),L.dataset.slide="next",L.innerHTML=' \n                          <span class="carousel-control-next-icon" aria-hidden="true"></span>\n                          <span class="sr-only">Next</span>\n              ',y.appendChild(b),y.appendChild(v),y.appendChild(S),y.appendChild(L),y.ondblclick=()=>{!function(e){const t=document.querySelector("#contenedor_carrousel_grande");n(t);const a=document.createElement("DIV");a.id="carousel_grande",a.classList.add("carousel","slide","float-right","col-md-3"),a.dataset.ride="carousel",a.style.maxWidth="40rem",a.style.maxHeight="40rem",a.style.padding="0px";const o=document.createElement("OL");o.classList.add("carousel-indicators");const c=document.createElement("DIV");c.classList.add("carousel-inner");let r=1;e.forEach(e=>{if(""!=e){const t=document.createElement("LI");t.dataset.target="#carousel_grande",t.dataset.slideTo=""+r;const n=document.createElement("DIV");n.classList.add("carousel-item");const a=document.createElement("IMG");a.classList.add("d-block","w-100"),a.src=`/img/notificaciones/${e}.png`,1==r&&(t.classList.add("active"),n.classList.add("active")),o.appendChild(t),n.appendChild(a),c.appendChild(n),r++}});const s=document.createElement("A");s.classList.add("carousel-control-prev"),s.href="#carousel_grande",s.setAttribute("role","button"),s.dataset.slide="prev",s.innerHTML='\n                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>\n                    <span class="sr-only">Previous</span>\n        ';const i=document.createElement("A");i.classList.add("carousel-control-next"),i.href="#carousel_grande",i.setAttribute("role","button"),i.dataset.slide="next",i.innerHTML=' \n                    <span class="carousel-control-next-icon" aria-hidden="true"></span>\n                    <span class="sr-only">Next</span>\n        ',a.appendChild(o),a.appendChild(c),a.appendChild(s),a.appendChild(i),$("#modal-carrousel-imagenes").modal("show"),t.appendChild(a)}(l)},g.appendChild(h),g.appendChild(f),m.appendChild(y),m.appendChild(p),m.appendChild(g),u.appendChild(m),d.appendChild(u),r.appendChild(d)}),c.appendChild(r)}(await a.json())}catch(e){}}function t(e){n(u),m=e.id,$("#modal-notificacion").modal("show"),c(),l.value=e.mensaje,0!=e.imagenes.length&&e.imagenes.forEach(e=>{const t=document.createElement("img");t.classList.add("col-md-4","mb-3"),t.src=`../img/notificaciones/${e}.png`,t.setAttribute("alt","no hay imágenes"),u.appendChild(t)})}function n(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function a(){const e=window.location.href,t=new URL(e);return id=t.searchParams.get("id")}function o(){document.querySelector("#toastsContainerTopRight")&&document.querySelector("#toastsContainerTopRight").remove()}function c(){$.validator.setDefaults({submitHandler:function(){!async function(){const t=new FormData;t.append("mensaje",l.value.trim()),t.append("reparacion_id",a());const n=d.files;if(n.length>0)for(let e=0;e<n.length;e++)t.append("imagenes[]",n[e]);else t.append("imagenes[]",[]);r.disabled=!0;let c="";m?(t.append("id",m),c="/api/reparacion/editar-notificacion"):c="/api/reparacion/crear-notificacion";try{const n=await fetch(c,{body:t,method:"POST"}),a=await n.json();o(),r.disabled=!1,"error"==a.type?$(document).Toasts("create",{class:"bg-danger",title:"Error",body:a.msg}):($(document).Toasts("create",{class:"bg-azul text-blanco",title:"Completado",body:a.msg}),setTimeout(()=>{o()},4e3),i.reset(),$("#modal-notificacion").modal("hide"),e())}catch(e){}}()}}),$("#notificacionForm").validate({rules:{mensaje:{required:!0}},messages:{mensaje:{required:"El mensaje de la notifiación es Obligatorio"}},errorElement:"span",errorPlacement:function(e,t){e.addClass("invalid-feedback"),t.closest(".form-group").append(e)},highlight:function(e,t,n){$(e).addClass("is-invalid")},unhighlight:function(e,t,n){$(e).removeClass("is-invalid")}})}s.addEventListener("click",(function(e){i.reset(),n(u),$("#modal-notificacion").modal("show"),c()})),e(),d.addEventListener("change",(function(e){n(u);const t=e.target.files;for(let e=0;e<t.length;e++){const n=t[e],a=new FileReader;a.onload=function(e){const t=document.createElement("img");t.src=e.target.result,t.classList.add("col-md-4","mb-3"),u.appendChild(t)},a.readAsDataURL(n)}})),$("#notificacionForm").on("valid",(function(e){c()}))}}(),function(){if(document.querySelector("#tabla-ingresos")){let c;const r=document.querySelector("#agregar-ingreso"),s=document.querySelector("#ingresoForm"),i=document.querySelector("#ingreso"),l=document.querySelector("#descripcion_ingreso"),d=document.querySelector("#btnSubmitIngreso"),u=document.querySelector("#totalIngresos");async function e(){const a=t(),c=`${location.origin}/api/reparacion/ingresos?id=${a}`;try{const t=await fetch(c);!function(t){const a=document.querySelector("#tabla-ingresos");!function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}(a);const c=document.createElement("tbody"),r=t.reduce((function(e,t){return e+parseFloat(t.ingreso)}),0);u.textContent=r.toLocaleString("en"),t.forEach(t=>{const{id:a,ingreso:r,descripcion:s,reparacion_id:i}=t,l=document.createElement("tr"),d=document.createElement("td");d.classList.add("py-2"),d.style.minWidth="130px",d.innerHTML=`Valor: $<strong>${parseFloat(r).toLocaleString("en")}</strong>`;const u=document.createElement("td");u.classList.add("py-2"),u.innerHTML=`Descripcion: <strong style="max-width:30px !important">${s}</strong>`;const m=document.createElement("td");m.classList.add("py-2"),m.style.minWidth="120px";const p=document.createElement("BUTTON");p.type="button",p.classList.add("btn","btn-sm","bg-hover-azul","mx-2","text-white","toolMio"),p.innerHTML="<span class='toolMio-text'>Editar</span><i class='fas fa-pen'></i>",p.onclick=function(){n(t)};const g=document.createElement("BUTTON");g.type="button",g.classList.add("btn","btn-sm","bg-hover-azul","mx-2","text-white","toolMio"),g.innerHTML="<span class='toolMio-text'>Eliminar</span><i class='fas fa-trash'></i>",g.type="button",g.onclick=function(){var n;n=t,Swal.fire({icon:"warning",html:`<h2 class="">esta seguro de eliminar el Ingreso de <span class="font-weight-bold"> ${parseFloat(n.ingreso).toLocaleString("en")} </span>?</h2><br><p>Esta acción no se puede deshacer</p>`,showCancelButton:!0,confirmButtonText:"Eliminar",cancelButtonText:"Cancelar"}).then(t=>{t.isConfirmed&&async function(t){const n=new FormData;n.append("id",t);try{const t=await fetch("/api/reparacion/eliminar-ingreso",{body:n,method:"POST"}),a=await t.json();"error"==a.type?$(document).Toasts("create",{class:"bg-danger",title:"Error",body:a.msg}):($(document).Toasts("create",{class:"bg-azul text-blanco",title:"Completado",body:a.msg}),setTimeout(()=>{o()},8e3),e())}catch(e){}}(n.id)})},m.appendChild(p),m.appendChild(g),l.appendChild(d),l.appendChild(u),l.appendChild(m),c.appendChild(l)}),a.appendChild(c)}(await t.json())}catch(e){}}function t(){const e=window.location.href,t=new URL(e);return id=t.searchParams.get("id")}function n(e){c=e.id,$("#modal-ingreso").modal("show"),a(),i.value=parseFloat(e.ingreso).toLocaleString("en"),l.value=e.descripcion}function a(){$.validator.setDefaults({submitHandler:function(){!async function(){const n=new FormData;n.append("ingreso",i.value),n.append("descripcion",l.value.trim()),d.disabled=!0;let a="";c?(c&&n.append("id",c),a="/api/reparacion/editar-ingreso"):(a="/api/reparacion/crear-ingreso",n.append("reparacion_id",t()));try{const t=await fetch(a,{body:n,method:"POST"}),c=await t.json();o(),d.disabled=!1,"error"==c.type?$(document).Toasts("create",{class:"bg-danger",title:"Error",body:c.msg}):($(document).Toasts("create",{class:"bg-azul text-blanco",title:"Completado",body:c.msg}),setTimeout(()=>{o()},4e3),s.reset(),$("#modal-ingreso").modal("hide"),e())}catch(e){}}()}}),$("#ingresoForm").validate({rules:{ingreso:{required:!0}},messages:{ingreso:{required:"El valor del Ingreso es obligatorio"}},errorElement:"span",errorPlacement:function(e,t){e.addClass("invalid-feedback"),t.closest(".form-group").append(e)},highlight:function(e,t,n){$(e).addClass("is-invalid")},unhighlight:function(e,t,n){$(e).removeClass("is-invalid")}})}function o(){document.querySelector("#toastsContainerTopRight")&&document.querySelector("#toastsContainerTopRight").remove()}r.addEventListener("click",(function(e){s.reset(),c=null,$("#modal-ingreso").modal("show"),a()})),i.addEventListener("input",(function(e){const t=function(e){const t=e.target.value;let n=parseFloat(t.replace(/,/g,""));isNaN(n)&&(n="");return n.toLocaleString("en")}(e);i.value=t})),e(),$("#ingresoForm").on("valid",(function(e){a()}))}}(),function(){if(document.querySelector("#reparacion")){let c;const r=document.querySelector("#agregar-costo"),s=document.querySelector("#costoForm"),i=document.querySelector("#costo"),l=document.querySelector("#descripcion"),d=document.querySelector("#btnSubmitCosto"),u=document.querySelector("#totalCostos");async function e(){const a=t(),c=`${location.origin}/api/reparacion/costos?id=${a}`;try{const t=await fetch(c);!function(t){const a=document.querySelector("#tabla-costos");!function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}(a);const c=document.createElement("tbody"),r=t.reduce((function(e,t){return e+parseFloat(t.costo)}),0);u.textContent=r.toLocaleString("en"),t.forEach(t=>{const{id:a,costo:r,descripcion:s,reparacion_id:i}=t,l=document.createElement("tr"),d=document.createElement("td");d.classList.add("py-2"),d.style.minWidth="130px",d.innerHTML=`Valor: $<strong>${parseFloat(r).toLocaleString("en")}</strong>`;const u=document.createElement("td");u.classList.add("py-2"),u.innerHTML=`Descripcion: <strong style="max-width:30px !important">${s}</strong>`;const m=document.createElement("td");m.classList.add("py-2"),m.style.minWidth="120px";const p=document.createElement("BUTTON");p.type="button",p.classList.add("btn","btn-sm","bg-hover-azul","mx-2","text-white","toolMio"),p.innerHTML="<span class='toolMio-text'>Editar</span><i class='fas fa-pen'></i>",p.onclick=function(){n(t)};const g=document.createElement("BUTTON");g.type="button",g.classList.add("btn","btn-sm","bg-hover-azul","mx-2","text-white","toolMio"),g.innerHTML="<span class='toolMio-text'>Eliminar</span><i class='fas fa-trash'></i>",g.type="button",g.onclick=function(){var n;n=t,Swal.fire({icon:"warning",html:`<h2 class="">esta seguro de eliminar el costo de <span class="font-weight-bold"> ${parseFloat(n.costo).toLocaleString("en")} </span>?</h2><br><p>Esta acción no se puede deshacer</p>`,showCancelButton:!0,confirmButtonText:"Eliminar",cancelButtonText:"Cancelar"}).then(t=>{t.isConfirmed&&async function(t){const n=new FormData;n.append("id",t);try{const t=await fetch("/api/reparacion/eliminar-costo",{body:n,method:"POST"}),a=await t.json();console.log(a),"error"==a.type?$(document).Toasts("create",{class:"bg-danger",title:"Error",body:a.msg}):($(document).Toasts("create",{class:"bg-azul text-blanco",title:"Completado",body:a.msg}),setTimeout(()=>{o()},8e3),e(),console.log("recargano"))}catch(e){console.log(e)}}(n.id)})},m.appendChild(p),m.appendChild(g),l.appendChild(d),l.appendChild(u),l.appendChild(m),c.appendChild(l)}),a.appendChild(c)}(await t.json())}catch(e){}}function t(){const e=window.location.href,t=new URL(e);return id=t.searchParams.get("id")}function n(e){c=e.id,$("#modal-costo").modal("show"),a(),i.value=parseFloat(e.costo).toLocaleString("en"),l.value=e.descripcion}function a(){$.validator.setDefaults({submitHandler:function(){!async function(){const n=new FormData;n.append("costo",i.value),n.append("descripcion",l.value.trim()),d.disabled=!0;let a="";c?(c&&n.append("id",c),a="/api/reparacion/editar-costo"):(a="/api/reparacion/crear-costo",n.append("reparacion_id",t()));try{const t=await fetch(a,{body:n,method:"POST"}),c=await t.json();o(),d.disabled=!1,"error"==c.type?$(document).Toasts("create",{class:"bg-danger",title:"Error",body:c.msg}):($(document).Toasts("create",{class:"bg-azul text-blanco",title:"Completado",body:c.msg}),setTimeout(()=>{o()},4e3),s.reset(),$("#modal-costo").modal("hide"),e())}catch(e){}}()}}),$("#costoForm").validate({rules:{costo:{required:!0}},messages:{costo:{required:"El valor del costo es obligatorio"}},errorElement:"span",errorPlacement:function(e,t){e.addClass("invalid-feedback"),t.closest(".form-group").append(e)},highlight:function(e,t,n){$(e).addClass("is-invalid")},unhighlight:function(e,t,n){$(e).removeClass("is-invalid")}})}r.addEventListener("click",(function(e){s.reset(),c=null,$("#modal-costo").modal("show"),a()})),i.addEventListener("input",(function(e){const t=function(e){const t=e.target.value;let n=parseFloat(t.replace(/,/g,""));isNaN(n)&&(n="");return n.toLocaleString("en")}(e);i.value=t})),e(),$("#costoForm").on("valid",(function(e){a()}))}function o(){document.querySelector("#toastsContainerTopRight")&&document.querySelector("#toastsContainerTopRight").remove()}}(),function(){if(document.querySelector("#reparaciones")){let r;const s=["NO ESPECIFICA","SAMSUMG","MOTOROLA","NOKIA","HUAWEI","LG","XIAOMI","KRONO","LENOVO","ALCATEL","HIUNDAI","IPHONE","SENDTEL","ASUS","TOSHIBA","DELL","HP","OPPO","REALME","HONOR","POCO","VIVO","ACER","SONY","BLU","CATERPILLAR","HTC","INFINIX","MICROSOFT","PANASONIC","SHARP","SONY ERICSSON","TLC","ZTE","OTRAS"],i=document.querySelector("#reparacionForm");let l=null;const d=document.querySelector("#nombre"),u=document.querySelector("#direccion"),m=document.querySelector("#marca"),p=document.querySelector("#cedula_nit"),g=document.querySelector("#celular"),h=document.querySelector("#modelo"),f=document.querySelector("#imei_1"),y=document.querySelector("#imei_2"),b=document.querySelector("#falla"),v=document.querySelector("#proceso"),C=document.querySelector("#valor_convenido"),S=document.querySelector("#abono"),L=document.querySelector("#saldo"),E=document.querySelector("#cargador"),q=document.querySelector("#bateria"),T=document.querySelector("#tapa"),w=document.querySelector("#estuche"),x=document.querySelector("#sim"),O=document.querySelector("#sd"),I=document.querySelector("#observacion"),_=document.querySelector("#registrar");function e(e){const t=e.target.value;let n=parseFloat(t.replace(/,/g,""));isNaN(n)&&(n="");return n.toLocaleString("en")}function t(){i.reset(),btnSubmit.disabled=!1,$("#modal-reparacion").modal("show"),o(),l&&async function(){try{const e=await fetch("/api/reparacion?id="+l);!function(e){const t=JSON.parse(e.accesorios);d.value=e.nombre,p.value=e.cedula_nit,g.value=e.celular,u.value=e.direccion,c(e.marca),h.value=e.modelo,f.value=e.imei_1,y.value=e.imei_2,b.value=e.falla,v.value=e.proceso,C.value=parseFloat(e.valor_convenido).toLocaleString("en"),S.value=parseFloat(e.abono).toLocaleString("en"),L.value=parseFloat(e.saldo).toLocaleString("en"),0!=e.estado&&(S.readOnly=!0,C.readOnly=!0);1==t.cargador&&(E.checked=!0);1==t.bateria&&(q.checked=!0);1==t.estuche&&(w.checked=!0);1==t.tapa&&(T.checked=!0);1==t.sim&&(x.checked=!0);1==t.sd&&(O.checked=!0);I.value=e.observacion}(await e.json())}catch(e){console.log(e)}}()}async function n(){const e=new FormData;l&&e.append("id",l),e.append("nombre",d.value.trim()),e.append("cedula_nit",p.value.trim()),e.append("celular",g.value),e.append("direccion",u.value.trim()),e.append("marca",m.value),e.append("modelo",h.value.trim()),e.append("imei_1",f.value.trim()),e.append("imei_2",y.value.trim()),e.append("falla",b.value.trim()),e.append("proceso",v.value.trim()),e.append("valor_convenido",C.value),e.append("abono",S.value),e.append("saldo",L.value),e.append("observacion",I.value.trim()),e.append("accesorios",function(){checkOBJ.cargador=E.checked,checkOBJ.tapa=T.checked,checkOBJ.bateria=q.checked,checkOBJ.estuche=w.checked,checkOBJ.sim=x.checked,checkOBJ.sd=O.checked;return JSON.stringify(checkOBJ).replace(/\\/g,"")}());let t="";t=l?"/api/reparacion/editar":"/api/reparacion/crear";try{const n=await fetch(t,{body:e,method:"POST"}),o=await n.json();a(),btnSubmit.disabled=!1,"error"==o.type?$(document).Toasts("create",{class:"bg-danger",title:"Error",body:o.msg}):(r.ajax.reload(),$(document).Toasts("create",{class:"bg-azul text-blanco",title:"Completado",body:o.msg}),setTimeout(()=>{a()},4e3),i.reset(),$("#modal-reparacion").modal("hide"))}catch(e){}}function a(){document.querySelector("#toastsContainerTopRight")&&document.querySelector("#toastsContainerTopRight").remove()}function o(){$.validator.setDefaults({submitHandler:function(){n()}}),$("#reparacionForm").validate({rules:{nombre:{required:!0},cedula_nit:{required:!0},celular:{required:!0,digits:!0,minlength:10,maxlength:10},valor_convenido:{required:!0}},messages:{nombre:{required:"El nombre de la categoría es obligatorio"},cedula_nit:{required:"El Número de identificación es obligatorio"},celular:{required:"El Celular de contacto es obligatorio",digits:"El número de celular solo puede contener números",minlength:"El número de celular debe de ser de 10 digitos",maxlength:"El número de celular debe de ser de 10 digitos"},valor_convenido:{required:"El valor convenido es obligatorio"}},errorElement:"span",errorPlacement:function(e,t){e.addClass("invalid-feedback"),t.closest(".form-group").append(e)},highlight:function(e,t,n){$(e).addClass("is-invalid")},unhighlight:function(e,t,n){$(e).removeClass("is-invalid")}})}function c(e){for(;m.firstChild;)m.removeChild(m.firstChild);s.forEach(t=>{const n=document.createElement("OPTION");n.value=t,n.textContent=t,t==e&&(n.selected=!0),m.appendChild(n)})}checkOBJ={cargador:!1,bateria:!1,tapa:!1,estuche:!1,SIM:!1,SD:!1},$("#tabla").dataTable().fnDestroy(),r=$("#tabla").DataTable({ajax:"/api/reparaciones",deferRender:!0,retrieve:!0,proccesing:!0,responsive:!0,initComplete:function(){new $.fn.dataTable.Buttons(r,{buttons:["copy","csv","excel","pdf","print"]}).container().appendTo("#tabla_wrapper .col-md-6:eq(0)")}}),_.addEventListener("click",(function(){S.readOnly=!1,C.readOnly=!1,l=null,c("NO ESPECIFICA"),t()})),$("#reparaciones").on("click","#editar",(function(e){S.readOnly=!1,C.readOnly=!1,l=e.currentTarget.dataset.reparacionId,t()})),$("#reparaciones").on("click","#eliminar",(function(e){!function(e,t){const n=t.currentTarget.parentElement.parentElement.parentElement.childNodes[1].textContent;Swal.fire({icon:"warning",html:`<h2 class="">esta seguro de Cancelar la reparación del cliente <span class="font-weight-bold"> ${n} </span>?</h2><br><p>Esta acción no se puede deshacer</p>`,showCancelButton:!0,confirmButtonText:"Eliminar",cancelButtonText:"Cancelar"}).then(t=>{t.isConfirmed&&async function(e){const t=new FormData;t.append("id",e);try{const e=await fetch("/api/reparacion/eliminar",{body:t,method:"POST"}),n=await e.json();a(),"error"==n.type?$(document).Toasts("create",{class:"bg-danger",title:"Error",body:n.msg}):($(document).Toasts("create",{class:"bg-azul text-blanco",title:"Completado",body:n.msg}),setTimeout(()=>{a()},8e3),r.ajax.reload())}catch(e){$(document).Toasts("create",{class:"bg-danger",title:"Error",body:"No es Posible eliminar La reparacion porque tiene gastos y/o ingrseso asociados"}),setTimeout(()=>{a()},8e3)}}(e)})}(e.currentTarget.dataset.reparacionId,e)})),$("#reparaciones").on("click","#imprimir",(function(e){!async function(e){const t="/api/factura?key="+btoa(e);try{await fetch(t);window.open(t,"_blank")}catch(e){}}(e.currentTarget.dataset.reparacionId)})),C.addEventListener("input",(function(t){C.value=e(t),L.value=e(t),S.value=0})),S.addEventListener("input",(function(t){!function(e){const t=C.value,n=parseFloat(t.replace(/,/g,""));let a=parseFloat(e.target.value.replace(/,/g,""));""==a&&(a=0);const o=n-a;console.log(n),isNaN(o)&&(o="");const c=o.toLocaleString("en");L.value=c}(t),S.value=e(t)})),$("#reparacionForm").on("valid",(function(e){o()})),$(".select2").select2(),$(".select2bs4").select2({theme:"bootstrap4"})}}();
//# sourceMappingURL=bundle.js.map
